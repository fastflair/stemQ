{
       "Course": "Theory of Numbers",
       "Topic": "Tonelli's Algorithm",
       "Original question": "Solve x^2 \u2261 21 (mod 41) using Tonelli\u2019s algorithm.",
       "Solution": "Note that 41 \u2212 1 = 2^3 \u00b7 5. Start with a quadratic nonresidue mod 41, say, 3. Now b = 3^5 = 81 \u00b7 3 \u2261 \u22123 (mod 41), which has order exactly 8. (\u22123)^\u22121 \u2261 \u221214 (mod 41). Now we calculate a square root of 21. First, check that 21 is a square: 21^(41\u22121)/2) = 21^20 = 3^20 \u00b7 7^20 \u2261 \u22121 \u00b7 7^20 \u2261 \u22121 \u00b7 49^10 \u2261 -1 8^10 \u2261 -2^30 \u2261 \u22122^20 \u00b7 2^10 \u2261 \u22121 \u00b7 1024 \u2261 1 (mod 41). Next, calculate 21^10 \u2261 441^5 \u2261 (\u221210)^5 \u2261 18 \u00b7 18 \u00b7 (\u221210) \u2261 324 \u00b7 (\u221210) \u2261 (\u22128)(\u221210) \u2261 \u22121 (mod 41). So update A = (21)/(\u22123)^2 \u2261 21 \u00b7 14^2 = 21 \u00b7 196 \u2261 21 \u00b7 (\u22129) \u2261 16 (mod 41). Next, since 16^5 \u2261 2^20 \u2261 1 (mod 41), there is no need to modify A and b for this step. We\u2019re at the stage where A^odd \u2261 1 (mod 41), so a square root of A is A^((5+1)/2( = 16^3 \u2261 \u22124 (mod 41). (Note: we could have guessed a square root of 16 anyway since it\u2019s a perfect square.) Thus, a square root of 21 is given by (\u22123)(\u22124) \u2261 12 (mod 41). Check: 122 = 144 \u2261 21 (mod 41). The other square root of 21 is given by (\u22123)(\u22124) \u2261 12 (mod 41). Check: 122 = 144 \u2261 21 (mod 41). The other square root of 21 mod 41 is -12."
}